<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å®è´ä¸¤å‘¨å² - å½©è™¹ç³–æœæ‰‹è´¦å¢™</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap');

        :root {
            --bg-purple: #9b5de5;
            --white: #ffffff;
            --candy-pink: #f15bb5;
            --candy-yellow: #fee440;
            --candy-blue: #00bbf9;
            --candy-orange: #fb8500;
            --candy-green: #00f5d4;
            --dark: #2d2d2d;
        }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            background-color: var(--bg-purple);
            background-image: radial-gradient(rgba(255,255,255,0.15) 3px, transparent 3px);
            background-size: 70px 70px;
            font-family: 'ZCOOL KuaiLe', cursive;
        }

        /* å…¨å±æŒ‰é’® - ç»ç’ƒæ‹Ÿæ€é£æ ¼ */
        #fullscreen-btn {
            position: fixed; top: 20px; right: 20px; z-index: 99999;
            width: 60px; height: 60px; border: none; border-radius: 50%;
            background: rgba(255,255,255,0.25);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: all 0.3s ease;
        }
        #fullscreen-btn:hover {
            transform: scale(1.1);
            background: rgba(255,255,255,0.4);
        }
        #fullscreen-btn svg {
            width: 28px; height: 28px; fill: var(--white);
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        #star-layer { position: absolute; width: 100%; height: 100%; pointer-events: none; }

        /* å½©è™¹æ°”çƒ */
        .balloon {
            position: absolute; width: 80px; height: 100px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: balloonFloat 4s infinite ease-in-out;
        }
        .balloon::after {
            content: ''; position: absolute; width: 2px; height: 100px;
            background: #333; left: 50%; bottom: -100px; transform: translateX(-50%);
        }

        /* ä¸»èˆå° */
        .stage {
            display: flex; width: 100%; height: 100%;
            align-items: center; justify-content: center;
            gap: 120px; padding: 50px; box-sizing: border-box;
            position: relative; z-index: 50;
        }

        /* ç…§ç‰‡è£…é¥° */
        .photo-wrapper { position: relative; }
        .magic-wand {
            position: absolute; top: -75px; right: -50px;
            font-size: 90px; z-index: 60;
            filter: drop-shadow(6px 6px 0 rgba(0,0,0,0.2));
            animation: wandSparkle 2s infinite;
        }
        .photo-container {
            width: 420px; height: 420px;
            background: #fff; padding: 0px; border-radius: 40px;
            box-shadow: 20px 20px 0px rgba(0,0,0,0.15);
            border: 12px solid var(--candy-pink);
            position: relative; cursor: pointer;
            transform: rotate(1deg);
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; transition: 0.4s;
        }
        .photo-container:hover { transform: rotate(0deg) scale(1.08); }
        #baby-photo { width: 100%; height: 100%; object-fit: cover; display: none; }

        /* ç¥ç¦è¯­è´´çº¸ */
        .wish-tag {
            position: absolute; padding: 12px 28px;
            font-size: 2rem; font-weight: bold;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.12);
            z-index: 30; animation: candyFloat 5s infinite ease-in-out;
            white-space: nowrap;
        }
        .tag-lollipop { background: var(--candy-yellow); border-radius: 30px; border: 5px dotted var(--dark); }
        .tag-star { background: var(--candy-pink); color: white; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); }
        .tag-cloud { background: var(--candy-blue); color: white; border-radius: 50px; border: 4px solid var(--white); }
        .tag-heart { background: var(--candy-green); color: var(--dark); transform: rotate(-15deg); border-radius: 50% 0; }

        /* å›¾æ ‡è£…é¥° */
        .item { position: absolute; z-index: 10; filter: drop-shadow(8px 8px 0 rgba(0,0,0,0.1)); animation: candyFloat 6s infinite; }

        /* æ ‡é¢˜åŒºåŸŸ */
        .main-title {
            font-size: 10rem; color: var(--white);
            text-shadow: 10px 10px 0px var(--dark);
            margin: 0; letter-spacing: 12px;
            animation: candyPop 1.8s infinite alternate;
        }
        .date-sticker {
            background: var(--candy-orange); padding: 15px 45px; border-radius: 60px;
            border: 5px solid #333; font-size: 2.3rem; transform: rotate(-2deg);
            margin-top: 60px; color: white;
        }

        /* åŠ¨ç”»åº“ */
        @keyframes balloonFloat { 0%, 100% { transform: translateY(0) rotate(-5deg); } 50% { transform: translateY(-30px) rotate(5deg); } }
        @keyframes wandSparkle { 0%, 100% { transform: scale(1) rotate(0deg); } 50% { transform: scale(1.2) rotate(10deg); } }
        @keyframes candyFloat {
            0%, 100% { transform: translate(0, 0) rotate(var(--r)); }
            50% { transform: translate(15px, -25px) rotate(calc(var(--r) + 8deg)); }
        }
        @keyframes candyPop { from { transform: scale(1); } to { transform: scale(1.06); } }

        .bottom-banner {
            position: absolute; bottom: 25px; width: 100%;
            text-align: center; font-size: 2.5rem; color: white;
            letter-spacing: 18px; z-index: 100; font-weight: bold;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
        }

        #crop-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); z-index: 9999;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .crop-container { width: 80%; max-height: 70vh; background: #fff; }

        #confetti-canvas {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none; z-index: 1000;
        }
    </style>
</head>
<body>

    <!-- å…¨å±æŒ‰é’® -->
    <button id="fullscreen-btn" title="å…¨å±æ˜¾ç¤º">
        <svg viewBox="0 0 24 24">
            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
        </svg>
    </button>

    <canvas id="confetti-canvas"></canvas>
    <div id="star-layer"></div>

    <!-- å½©è™¹æ°”çƒ -->
    <div class="balloon" style="top: 10%; left: 5%; background: var(--candy-pink); animation-delay: 0s;"></div>
    <div class="balloon" style="top: 15%; right: 8%; background: var(--candy-yellow); animation-delay: 1s;"></div>
    <div class="balloon" style="bottom: 20%; left: 8%; background: var(--candy-blue); animation-delay: 2s;"></div>
    <div class="balloon" style="top: 20%; left: 50%; background: var(--candy-orange); animation-delay: 1.5s;"></div>

    <!-- ç¥ç¦è¯­è´´çº¸ -->
    <div class="wish-tag tag-lollipop" style="top: 12%; left: 10%; --r: -8deg;">ğŸ­ èªæ˜åŠ å€</div>
    <div class="wish-tag tag-star" style="top: 8%; right: 15%; --r: 12deg;">â­ é—ªé—ªå‘å…‰</div>
    <div class="wish-tag tag-cloud" style="bottom: 30%; left: 6%; --r: -6deg;">â˜ï¸ å¿«ä¹ç¿»å€</div>
    <div class="wish-tag tag-heart" style="bottom: 18%; right: 8%; --r: 10deg;">ğŸ’š å¥åº·æˆé•¿</div>
    <div class="wish-tag tag-lollipop" style="top: 35%; left: 3%; --r: 15deg; background: var(--candy-green);">ğŸŒŸ é­”æ³•æˆé•¿</div>
    <div class="wish-tag tag-star" style="top: 50%; right: 5%; --r: -10deg; background: var(--candy-orange);">ğŸ¨ åˆ›æ„æ— é™</div>
    <div class="wish-tag tag-cloud" style="top: 18%; left: 40%; --r: 8deg; background: var(--candy-pink);">ğŸŒˆ äº”å½©æ–‘æ–“</div>
    <div class="wish-tag tag-heart" style="bottom: 12%; left: 35%; --r: -12deg; background: var(--candy-yellow); color: var(--dark);">ğŸ‚ ä¸¤å²å¿«ä¹</div>
    <div class="wish-tag tag-lollipop" style="bottom: 28%; right: 25%; --r: 6deg; background: var(--candy-blue);">ğŸ¬ ç”œç”œèœœèœœ</div>
    <div class="wish-tag tag-star" style="top: 75%; left: 12%; --r: -4deg; background: var(--white); color: var(--dark);">â˜€ï¸ é˜³å…‰å®è´</div>

    <!-- å›¾æ ‡è£…é¥° -->
    <div class="item" style="top: 6%; left: 3%; font-size: 110px;">ğŸ­</div>
    <div class="item" style="top: 4%; right: 3%; font-size: 130px;">ğŸŒˆ</div>
    <div class="item" style="bottom: 4%; left: 4%; font-size: 150px;">ğŸ¬</div>
    <div class="item" style="bottom: 6%; right: 4%; font-size: 140px;">ğŸ‚</div>
    <div class="item" style="top: 22%; left: 22%; font-size: 70px;">âœ¨</div>
    <div class="item" style="top: 28%; right: 28%; font-size: 60px;">ğŸ§</div>
    <div class="item" style="top: 24%; right: 48%; font-size: 55px;">ğŸ©</div>
    <div class="item" style="bottom: 35%; left: 7%; font-size: 90px;">ğŸ§¸</div>
    <div class="item" style="top: 58%; right: 6%; font-size: 100px;">ğŸ¦</div>
    <div class="item" style="top: 23%; right: 15%; font-size: 80px;">ğŸª</div>
    <div class="item" style="bottom: 22%; left: 48%; font-size: 65px;">ğŸ¡</div>
    <div class="item" style="top: 3%; left: 46%; font-size: 55px;">â˜ï¸</div>

    <div class="stage">
        <div class="photo-wrapper">
            <div class="magic-wand">ğŸª„</div>
            <div class="photo-container" onclick="document.getElementById('file-input').click()">
                <img id="baby-photo" src="">
                <div id="upload-hint" style="display: flex;flex-direction: column;justify-content: center;align-items: center;">
                    <p style="font-size:80px; margin:0;">ğŸ‘§</p>
                    <p style="font-size:2rem; margin:10px 0;">ç‚¹å‡»ä¸Šä¼ (æ”¯æŒè£å‰ª)</p>
                </div>
            </div>
            <input type="file" id="file-input" hidden accept="image/*">
        </div>

        <div class="text-area">
            <h1 class="main-title">ä¸¤å‘¨å²å•¦</h1>
            <div class="date-sticker">
                <span style="margin-left: 15px;">æ„¿ä½ çš„ç«¥å¹´å¦‚ç³–æœèˆ¬ç”œç¾å¤šå½©</span>
            </div>
        </div>
    </div>

    <div class="bottom-banner">
        âœ¦ SWEET 2ND BIRTHDAY âœ¦ MAGIC GIRL âœ¦ SWEET 2ND BIRTHDAY âœ¦
    </div>

    <div id="crop-modal">
        <div class="crop-container"><img id="crop-image" src=""></div>
        <button onclick="confirmCrop()" style="padding:15px 60px; font-size:2rem; background:var(--candy-yellow); border:none; border-radius:50px; margin-top:30px; cursor:pointer; font-family:inherit; font-weight:bold;">å®Œæˆè£å‰ª</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <script>
        // å…¨å±åŠŸèƒ½
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    alert(`æ— æ³•è¿›å…¥å…¨å±æ¨¡å¼: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        });

        // ç›‘å¬å…¨å±çŠ¶æ€å˜åŒ–ï¼Œåˆ‡æ¢å›¾æ ‡
        document.addEventListener('fullscreenchange', () => {
            const svg = fullscreenBtn.querySelector('svg path');
            if (document.fullscreenElement) {
                // é€€å‡ºå…¨å±å›¾æ ‡
                svg.setAttribute('d', 'M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z');
            } else {
                // è¿›å…¥å…¨å±å›¾æ ‡
                svg.setAttribute('d', 'M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z');
            }
        });

        // åŠ¨æ€èƒŒæ™¯æ˜Ÿæ˜Ÿ
        const starLayer = document.getElementById('star-layer');
        for (let i = 0; i < 50; i++) {
            const star = document.createElement('div');
            star.innerHTML = 'âœ¦';
            star.style.position = 'absolute';
            star.style.left = Math.random() * 100 + 'vw';
            star.style.top = Math.random() * 100 + 'vh';
            star.style.color = 'white';
            star.style.opacity = Math.random() * 0.6;
            star.style.fontSize = Math.random() * 25 + 15 + 'px';
            star.style.animation = `candyPop ${Math.random()*3+2}s infinite alternate`;
            starLayer.appendChild(star);
        }

        // è£å‰ªé€»è¾‘
        const fileInput = document.getElementById('file-input');
        const cropModal = document.getElementById('crop-modal');
        const cropImage = document.getElementById('crop-image');
        const babyPhoto = document.getElementById('baby-photo');
        let cropper = null;

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    cropImage.src = event.target.result;
                    cropModal.style.display = 'flex';
                    if(cropper) cropper.destroy();
                    setTimeout(() => {
                        cropper = new Cropper(cropImage, { aspectRatio: 1, viewMode: 1 });
                    }, 100);
                };
                reader.readAsDataURL(file);
            }
        });

        function confirmCrop() {
            const canvas = cropper.getCroppedCanvas({ width: 800, height: 800 });
            babyPhoto.src = canvas.toDataURL();
            babyPhoto.style.display = 'block';
            document.getElementById('upload-hint').style.display = 'none';
            cropModal.style.display = 'none';
        }
    </script>
    <script>
        // ç³–æœå½©å±‘ç³»ç»Ÿ
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        let canvasW, canvasH;
        const particles = [];
        const colors = ['#f15bb5', '#fee440', '#00bbf9', '#fb8500', '#00f5d4', '#ffffff'];
        const shapes = ['square', 'circle', 'star'];

        function initCanvas() {
            canvasW = canvas.width = window.innerWidth;
            canvasH = canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', initCanvas);
        initCanvas();

        class Particle {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * canvasW;
                this.y = Math.random() * canvasH - canvasH;
                this.size = Math.random() * 12 + 10;
                this.color = colors[Math.floor(Math.random() * colors.length)];
                this.shape = shapes[Math.floor(Math.random() * shapes.length)];
                this.speedX = Math.random() * 3 - 1.5;
                this.speedY = Math.random() * 4 + 3;
                this.rotation = Math.random() * 360;
                this.rotationSpeed = Math.random() * 15 - 7.5;
            }
            update() {
                this.y += this.speedY;
                this.x += this.speedX;
                this.rotation += this.rotationSpeed;
                if (this.y > canvasH) this.reset();
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation * Math.PI / 180);
                ctx.fillStyle = this.color;
                ctx.beginPath();
                if (this.shape === 'circle') {
                    ctx.arc(0, 0, this.size / 2, 0, Math.PI * 2);
                } else if (this.shape === 'star') {
                    for (let i = 0; i < 5; i++) {
                        ctx.lineTo(Math.cos((18 + i * 72) * Math.PI / 180) * this.size / 2,
                                  -Math.sin((18 + i * 72) * Math.PI / 180) * this.size / 2);
                        ctx.lineTo(Math.cos((54 + i * 72) * Math.PI / 180) * this.size / 4,
                                  -Math.sin((54 + i * 72) * Math.PI / 180) * this.size / 4);
                    }
                } else {
                    ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
                }
                ctx.fill();
                ctx.restore();
            }
        }

        for (let i = 0; i < 120; i++) {
            particles.push(new Particle());
        }

        function animate() {
            ctx.clearRect(0, 0, canvasW, canvasH);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animate);
        }
        animate();

    </script>
</body>
</html>